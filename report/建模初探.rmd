---
title: "建模初探"
author: "戎翔"
date: "2020/4/2"
output: html_document
---
一、
本次疫情来势汹汹，大有席卷全球之势。而意大利作为古罗马的遗存，不论是其政治，经济角色亦或文化影响力都称得上欧洲比较重要国家。而且意大利一年前正式加入了新丝绸之路（一带一路）项目，两国签署了包括谅解备忘录的多达29项协议，这在G7成员国当中是第一家。我们使用的是意大利 2020 年 3 月 1 日到 2020 年 3 月 30 日的疫情数据。数据来自世界卫生组织和意大利卫生部。
二、
我们准备用时间序列的Arima模型拟合累计死亡序列，以评估疫情的发展情况。ARIMA是一种比较常用的基于历史数据来做预测的时间序列模型。时间序列在商业中有很多应用，比如它可以解释销售中的季节性规律；可以预测新客或流失客户的数量等。ARIMA的全称是auto-regressive integrated moving average，主要是由三个参数确定的，即(p,d,q)。p指的是回归过程中某个时间点的取值依赖于过去的p个时间点的取值，d为差分次数，q为模型的的误差是之前误差的组合。
从图片可以看出原始序列是显著非平稳序列，累计死亡人数曲线呈现指数增加的趋势，因此尝试用二阶差分让其平稳。从图中可以看到在3月15号之前累计死亡人数增加较慢，15号以后逐渐递增。


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rmarkdown)
library(xtable)
library(zoo)
library(forecast)
library(readxl)
q <- read_excel("C:/Users/LL/Desktop/sj/a/q.xlsx")
View(q)
q=as.data.frame(q)
q1=ts(q$`total deaths`,start=1,frequency = 1)
plot(q1)
```

## 累计死亡

```{r pressure, echo=FALSE}
library(rmarkdown)
library(xtable)
library(zoo)
library(forecast)
library(readxl)
q <- read_excel("C:/Users/LL/Desktop/sj/a/q.xlsx")
View(q)
q=as.data.frame(q)
q1=ts(q$`total deaths`,start=1,frequency = 1)
plot(q1)
```

这是二阶差分后的a2序列
直观的看，似乎平稳了。经过adf单位根检验，其p值小于0.05，因此二阶差分之后的新序列是平稳的。然后对新曲线进行白噪声检验，确定其不是纯随机序列，有分析的价值。

```{r echo=FALSE}
library(rmarkdown)
library(xtable)
library(zoo)
library(forecast)
library(readxl)
q <- read_excel("C:/Users/LL/Desktop/sj/a/q.xlsx")
View(q)
q=as.data.frame(q)
q1=ts(q$`total deaths`,start=1,frequency = 1)
plot(diff(q1,1,2))
```

然后生成二阶差分序列的acf图和pacf图，从两幅图可知自相关系数和偏自相关系数均为拖尾特性，应该尝试拟合Arma模型。
```{r echo=FALSE}
acf(diff(q1,1,2))
pacf(diff(q1,1,2))
```

在r语言中，有auto.arima函数可以自动判断（p，d，q）取值。根据这个函数给出的结果，决定采用Arma（2,1）对二阶差分序列建模。
q1fit为根据二阶差分序列拟合的结果
q1fit:〖（1+0.2605B+0.1496B^2）（1-B）〗^2 x_t=（1-0.4108B）ε_t
综合模型看来，累计死亡和最近两期数据的关系比较大，意大利疫情的增长曲线正趋于平缓，疫情正在进入平台期，采取封锁措施这一重大决定正在见效。因此建议意大利继续坚持全国“封城”状态，阻断病毒蔓延趋势，继续关闭全国除食品店和药店以外的所有商铺。为保证公众基本生活，可以维持公共交通、物流和食品生产行业的运行。